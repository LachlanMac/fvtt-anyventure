{{!-- Spells Tab Content --}}
<div class="spells-section">
  <div class="section-header">
    <h3>Spells</h3>
    <div class="spell-slots">
      <label>Spell Slots: {{spells.length}} / {{system.spellSlots.max}}</label>
    </div>
    <a class="item-control item-create" title="Create spell" data-type="spell"><i class="fas fa-plus"></i></a>
  </div>

  <div class="spells-list">
    {{#each spellGroups as |group|}}
      {{!-- School Header --}}
      <div class="spell-school-header">
        <div class="school-header-content">
          <h3>{{group.schoolName}}</h3>
          {{#if group.castingFormula}}
          <span class="casting-formula">{{group.castingFormula}}</span>
          {{/if}}
        </div>
      </div>

      {{!-- Spells in this school --}}
      {{#each group.spells as |item|}}
      <div class="anyventure-spell-card {{#if item.system.fizzled}}fizzled{{/if}}" data-item-id="{{item._id}}">

        {{!-- Spell Icon --}}
        <div class="spell-icon">
          <img src="{{item.img}}" title="{{item.name}}" alt="{{item.name}}"/>
        </div>

        {{!-- Spell Content --}}
        <div class="spell-content">
          <div class="spell-header">
            <div class="spell-name">{{item.name}}</div>

            <div class="spell-tags">
              {{#if item.system.concentration}}
              <span class="concentration-badge">Concentration</span>
              {{/if}}
            </div>

            <div class="spell-energy">
              <div class="energy-line">
                {{#if item.system.energy}}
                  Energy: {{#each (range 1 (add item.system.energy 1))}}<i class="fas fa-star"></i>{{/each}}
                {{else}}
                  Energy: None
                {{/if}}
              </div>
            </div>
          </div>

          <div class="spell-details">
            <div class="spell-school">
              {{#if item.system.subschool}}{{item.system.subschool}}{{/if}}
            </div>

            <div class="spell-range">
              {{#if item.system.range}}{{formatSpellRange item.system.range}}{{/if}}
            </div>
          </div>
        </div>

        {{!-- Spell Check Side Column --}}
        <div class="spell-side">
          <div class="spell-check">
            <div class="check-label">Check</div>
            <div class="check-box">{{item.system.checkToCast}}</div>
          </div>
        </div>

        {{!-- Controls --}}
        <div class="spell-controls" onclick="event.stopPropagation();">
          <a class="item-control item-edit" title="Edit Spell"><i class="fas fa-edit"></i></a>
          <a class="item-control item-delete" title="Delete Spell"><i class="fas fa-trash"></i></a>
        </div>

      </div>
      {{/each}}
    {{/each}}

    {{#unless spells}}
    <div class="empty-message">
      <p>No spells learned yet. Create a spell to get started!</p>
    </div>
    {{/unless}}
  </div>
</div>
